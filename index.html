<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World Puzzle Battle</title>
    <meta name="google-adsense-account" content="ca-pub-4253911322239903">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4253911322239903"
     crossorigin="anonymous"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="notice-bar">
        <span class="notice-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="red">
                <path d="M12,8H4A2,2 0 0,0 2,10V14A2,2 0 0,0 4,16H5V20A1,1 0 0,0 6,21H8A1,1 0 0,0 9,20V16H12L17,20V4L12,8M21.5,12C21.5,13.71 20.54,15.26 19,16V8C20.53,8.74 21.5,10.28 21.5,12Z" />
            </svg>
        </span>
        <span class="notice-text">Welcome to the Puzzle Challenge! 1ë“± ë‘ì«€ì¿ (16ì¼ ê¸ˆ 13ì‹œ ê¸°ì¤€)!</span>
    </div>
    <h1>World Puzzle Battle</h1>
    
    <div class="controls">
        <label for="difficulty-selector">Difficulty: </label>
        <select id="difficulty-selector">
            <option value="4" selected>Easy (4x4 - 16pcs)</option>
            <option value="6">Normal (6x6 - 36pcs)</option>
            <option value="8">Hard (8x8 - 64pcs)</option>
        </select>
    </div>

    <div class="image-controls">
        <button id="today-image-btn" class="primary-btn">ğŸ“… Today's Challenge</button>
        <button id="random-image-btn" class="secondary-btn">ğŸ² Random Image</button>
    </div>
    
    <div id="timer">Time: 0.0s</div>
    
    <div id="sidebar-wrapper">
        <div id="rank-guide">
            <h4>ğŸ† Ranking Rules</h4>
            <ul>
                <li>1. <b>Score System</b> based</li>
                <li>2. <b>High Difficulty</b> = More Pts</li>
                <li>3. <b>Today's</b> = +50% Bonus</li>
                <li>4. <b>Faster Time</b> = More Pts</li>
                <li class="expiration">Records expire in 24h<br>(Hard mode: 5 days)</li>
            </ul>
        </div>
        <div id="leaderboard">
            <h3>Top 3 Records</h3>
            <ul id="leaderboard-list">
                <!-- Records will be injected here -->
            </ul>
        </div>
        <button id="main-share-btn" class="leaderboard-share-btn">ğŸ”— Share Game</button>
        <a href="#" id="partnership-link" style="text-align: center; font-size: 0.8rem; color: #666; text-decoration: none; margin-top: 5px; font-weight: bold;">ğŸ¤ ì œíœ´ ë¬¸ì˜</a>
    </div>

    <div id="game-area">
        <div id="original-image-container" style="display: none;">
            <img id="original-image" src="" alt="Original">
        </div>
        <button id="toggle-ref-btn" style="display: none;">ğŸ‘ï¸ View Ref</button>
        <div id="puzzle-container"></div>
    </div>
    <button id="start-button" style="display: none;">Start Puzzle</button> <!-- Hidden initially, shown after image load -->
    
    <!-- Partnership Modal -->
    <div id="partnership-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3>ğŸ¤ ì œíœ´ ë¬¸ì˜</h3>
            <form action="https://formspree.io/f/mkoongyj" method="POST">
                <div style="display: flex; flex-direction: column; gap: 10px; text-align: left;">
                    <label style="font-size: 0.9rem;">ì„±í•¨/ê¸°ì—…ëª…</label>
                    <input type="text" name="name" required placeholder="í™ê¸¸ë™" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                    
                    <label style="font-size: 0.9rem;">íšŒì‹  ì´ë©”ì¼</label>
                    <input type="email" name="_replyto" required placeholder="example@email.com" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                    
                    <label style="font-size: 0.9rem;">ë¬¸ì˜ ë‚´ìš©</label>
                    <textarea name="message" required rows="5" placeholder="ì œíœ´ ì œì•ˆ ë‚´ìš©ì„ ì ì–´ì£¼ì„¸ìš”." style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; resize: none;"></textarea>
                </div>
                <div class="modal-buttons" style="margin-top: 20px;">
                    <button type="submit" style="background-color: #28a745;">ë¬¸ì˜ ë³´ë‚´ê¸°</button>
                    <button type="button" id="close-partnership-btn" style="background-color: #888;">ì·¨ì†Œ</button>
                </div>
            </form>
        </div>
    </div>

    <div id="success-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>ì„±ê³µ! ì¶•í•˜í•©ë‹ˆë‹¤!</h2>
            <p id="success-time"></p>
            <p>í¼ì¦ì„ ì™„ì„±í•˜ì…¨ìŠµë‹ˆë‹¤.</p>
            <div style="display: flex; gap: 5px; margin-bottom: 5px;">
                <select id="success-country" style="width: 80px; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                    <option value="ğŸ‡°ğŸ‡·">ğŸ‡°ğŸ‡·</option>
                    <option value="ğŸ‡ºğŸ‡¸">ğŸ‡ºğŸ‡¸</option>
                    <option value="ğŸ‡¯ğŸ‡µ">ğŸ‡¯ğŸ‡µ</option>
                    <option value="ğŸ‡¨ğŸ‡³">ğŸ‡¨ğŸ‡³</option>
                    <option value="ğŸ‡¬ğŸ‡§">ğŸ‡¬ğŸ‡§</option>
                    <option value="ğŸ‡«ğŸ‡·">ğŸ‡«ğŸ‡·</option>
                    <option value="ğŸ‡©ğŸ‡ª">ğŸ‡©ğŸ‡ª</option>
                    <option value="ğŸ‡®ğŸ‡¹">ğŸ‡®ğŸ‡¹</option>
                    <option value="ğŸ‡ªğŸ‡¸">ğŸ‡ªğŸ‡¸</option>
                    <option value="ğŸ‡¨ğŸ‡¦">ğŸ‡¨ğŸ‡¦</option>
                    <option value="ğŸ‡§ğŸ‡·">ğŸ‡§ğŸ‡·</option>
                    <option value="ğŸ‡¦ğŸ‡·">ğŸ‡¦ğŸ‡·</option>
                    <option value="ğŸ‡¦ğŸ‡º">ğŸ‡¦ğŸ‡º</option>
                    <option value="ğŸ‡®ğŸ‡³">ğŸ‡®ğŸ‡³</option>
                    <option value="ğŸ‡»ğŸ‡³">ğŸ‡»ğŸ‡³</option>
                    <option value="ğŸ‡¹ğŸ‡­">ğŸ‡¹ğŸ‡­</option>
                    <option value="ğŸ‡®ğŸ‡©">ğŸ‡®ğŸ‡©</option>
                    <option value="ğŸ‡·ğŸ‡º">ğŸ‡·ğŸ‡º</option>
                    <option value="ğŸ‡ºğŸ‡¦">ğŸ‡ºğŸ‡¦</option>
                    <option value="ğŸ‡¹ğŸ‡·">ğŸ‡¹ğŸ‡·</option>
                    <option value="ğŸ‡¸ğŸ‡¦">ğŸ‡¸ğŸ‡¦</option>
                    <option value="ğŸ‡¿ğŸ‡¦">ğŸ‡¿ğŸ‡¦</option>
                    <option value="ğŸ‡ªğŸ‡¬">ğŸ‡ªğŸ‡¬</option>
                    <option value="ğŸŒ">ğŸŒ</option>
                </select>
                <input type="text" id="success-nickname" placeholder="ë‹‰ë„¤ì„ (5ì ì´ë‚´)" maxlength="5" style="flex-grow: 1;">
            </div>
            <textarea id="success-thoughts" placeholder="ì„±ê³µ ì†Œê°ì„ ì…ë ¥í•´ì£¼ì„¸ìš” (20ì ì´ë‚´)..." rows="4" maxlength="20"></textarea>
            <div class="modal-buttons">
                <button id="save-record-btn">ê¸°ë¡ ì €ì¥ & ë‹«ê¸°</button>
                <button id="share-btn" style="background-color: #007bff;">ê³µìœ í•˜ê¸°</button>
                <button id="close-modal-btn" style="background-color: #888;">ë‹«ê¸°</button>
            </div>
        </div>
    </div>

    <script type="module" src="main.js"></script>
</body>
</html>